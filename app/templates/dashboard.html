<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
    <title>AdminHub</title>
    <style>
        /* Basic Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Could be more or less, depending on screen size */
            border-radius: 5px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        /* Form Styles */
        input[type="text"], select {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50; /* Green */
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .alert {
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
        }
        .alert-success {
            background-color: #d4edda;
            color: #155724;
        }
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>

    <!-- SIDEBAR -->
    <section id="sidebar">
        <a href="#" class="brand">
            <i class='bx bxs-smile'></i>
            <span class="text">Admin</span>
        </a>
        <ul class="side-menu top">
            <li class="active">
                <a href="#">
                    <i class='bx bxs-dashboard'></i>
                    <span class="text">Dashboard</span>
                </a>
            </li>
            <li>
                <a href="#" id="videos-section">
                    <i class='bx bxs-video'></i>
                    <span class="text">My Videos</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class='bx bxs-doughnut-chart'></i>
                    <span class="text">Assignments</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class='bx bxs-message-dots'></i>
                    <span class="text">Files</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class='bx bxs-message-dots'></i>
                    <span class="text">Requests</span>
                </a>
            </li>

        </ul>
        <ul class="side-menu">
            <li>
                <a href="{ url_for(__init__.index) }" class="logout">
                    <i class='bx bxs-log-out-circle'></i>
                    <span class="text">Logout</span>
                </a>
            </li>
        </ul>
    </section>
    <!-- SIDEBAR -->

    <!-- CONTENT -->
    <section id="content">
        <!-- NAVBAR -->
        <nav>
            <i class='bx bx-menu'></i>
            <a href="#" class="nav-link">Categories</a>
            <form action="#">
                <div class="form-input">
                    <input type="search" placeholder="Search...">
                    <button type="submit" class="search-btn"><i class='bx bx-search'></i></button>
                </div>
            </form>
            <input type="checkbox" id="switch-mode" hidden>
            <label for="switch-mode" class="switch-mode"></label>
            <a href="#" class="notification">
                <i class='bx bxs-bell'></i>
                <span class="num">8</span>
            </a>
            <a href="#" class="profile">
                <img src="c:\Users\NoteBook\Documents\work\adminhub-master\img\Annotation 2024-03-17 065933.png">
            </a>
        </nav>
        <!-- NAVBAR -->
        <!-- MAIN -->
        <main>
            <div class="head-title">
                <div class="left">
                    <h1>Dashboard</h1>
                    <ul class="breadcrumb">
                        <li><a href="#">Dashboard</a></li>
                        <li><i class='bx bx-chevron-right'></i></li>
                        <li><a class="active" href="#">Home</a></li>
                    </ul>
                </div>
                <div class="buttons">
                    
                </div>
            </div>

            <ul class="box-info">
                
                
            </ul>

            <ul id="video-list">
                <!-- Videos will be populated here -->
            </ul>

            <div class="dashboard-buttons">
                <a href="{{ url_for('courses.get_courses') }}" class="btn btn-primary">View Courses</a>
                <a href="#" class="btn btn-success" id="add-course-btn">Add Course</a>
            </div>

            <div id="add-course-modal" class="modal">
                <div class="modal-content">
                    <span class="close" id="close-add-course">&times;</span>
                    <h2>Add Course</h2>
                    <form id="add-course-form">
                        <input type="text" id="course-name" placeholder="Course Name" required>
                        <button type="submit">Add Course</button>
                    </form>
                    <div id="add-course-error" class="alert alert-danger d-none"></div>
                    <div id="add-course-success" class="alert alert-success d-none"></div>
                </div>
            </div>
        </main>
    </section>
    <!-- CONTENT -->

    <!-- Video Upload Modal -->
    <div class="modal" id="upload-video-modal">
        <div class="modal-content">
            <span class="close" id="close-upload-video">&times;</span>
            <h2>Upload Video</h2>
            <form id="upload-video-form">
                <input type="text" id="video-title" placeholder="Video Title" required>
                <input type="text" id="video-description" placeholder="Video Description" required>
                <input type="text" id="video-url" placeholder="Video URL" required>
                <select id="video-course" required>
                    <option value="">Select Course</option>
                    {% for course in courses %}
                    <option value="{{ course.id }}">{{ course.name }}</option>
                    {% endfor %}
                </select>
                <button type="submit">Upload</button>
            </form>
            <div id="upload-error" class="alert alert-danger d-none"></div>
        </div>
    </div>
    <!-- Video Upload Form -->
<div id="video-upload-section" class="video-upload-section">
    <h2>Upload Video</h2>
    <form id="video-upload-form">
        <input type="text" id="video-title" placeholder="Video Title" required>
        <input type="text" id="video-description" placeholder="Video Description" required>
        
        <!-- Dropdown for selecting a course -->
        <select id="course-select" required>
            <option value="" disabled selected>Select a Course</option>
            <option value="bio">Biology</option>
            <option value="geo">Geography</option>
            <!-- Add more courses here if needed -->
        </select>

        <input type="file" id="video-file" accept="video/*" required>
        <button type="submit">Upload Video</button>
    </form>
    <div id="video-upload-error" class="alert alert-danger d-none">Error uploading video!</div>
    <div id="video-upload-success" class="alert alert-success d-none">Video uploaded successfully!</div>
</div>
<!-- Assignments Upload -->
<div id="assignments-upload-section" class="upload-section">
    <h2>Upload Assignment</h2>
    <form id="assignments-upload-form">
        <input type="text" id="assignment-title" placeholder="Assignment Title" required>
        <input type="text" id="assignment-description" placeholder="Assignment Description" required>
        
        <!-- Dropdown for selecting a course -->
        <select id="assignment-course-select" required>
            <option value="" disabled selected>Select a Course</option>
            <option value="bio">Biology</option>
            <option value="geo">Geography</option>
            <!-- Add more courses here if needed -->
        </select>

        <!-- Dropdown for selecting a stage -->
        <select id="assignment-stage-select" required>
            <option value="" disabled selected>Select a Stage</option>
            <option value="first-grade">First Grade</option>
            <option value="second-grade">Second Grade</option>
            <option value="third-grade">Third Grade</option>
        </select>

        <!-- Accept only PDF files -->
        <input type="file" id="assignment-file" accept=".pdf" required>
        <button type="submit">Upload Assignment</button>
    </form>
    <div id="assignment-upload-error" class="alert alert-danger d-none">Error uploading assignment!</div>
    <div id="assignment-upload-success" class="alert alert-success d-none">Assignment uploaded successfully!</div>
</div>
<!-- Courses Upload Modal -->
<div class="modal fade" id="uploadCourseModal" tabindex="-1" role="dialog" aria-labelledby="uploadCourseModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="uploadCourseModalLabel">Upload Course</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="course-upload-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="course-title">Course Title</label>
                        <input type="text" class="form-control" id="course-title" placeholder="Enter course title" required>
                    </div>
                    <div class="form-group">
                        <label for="course-description">Description</label>
                        <input type="text" class="form-control" id="course-description" placeholder="Enter course description" required>
                    </div>
                    <div class="form-group">
                        <label for="course-subject">Subject</label>
                        <select class="form-control" id="course-subject" required>
                            <option value="" disabled selected>Select subject</option>
                            <option value="bio">Biology</option>
                            <option value="geo">Geography</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="course-stage">Stage</label>
                        <select class="form-control" id="course-stage" required>
                            <option value="" disabled selected>Select stage</option>
                            <option value="first-grade">First Grade</option>
                            <option value="second-grade">Second Grade</option>
                            <option value="third-grade">Third Grade</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="course-file">Upload Course File</label>
                        <input type="file" class="form-control" id="course-file" accept=".pdf" required>
                    </div>
                    <button type="submit" class="btn btn-primary mt-3">Upload Course</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Exams Upload Modal -->
<div class="modal fade" id="uploadExamModal" tabindex="-1" role="dialog" aria-labelledby="uploadExamModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="uploadExamModalLabel">Upload Exam</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="exam-upload-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="exam-title">Exam Title</label>
                        <input type="text" class="form-control" id="exam-title" placeholder="Enter exam title" required>
                    </div>
                    <div class="form-group">
                        <label for="exam-description">Description</label>
                        <input type="text" class="form-control" id="exam-description" placeholder="Enter exam description" required>
                    </div>
                    <div class="form-group">
                        <label for="exam-subject">Subject</label>
                        <select class="form-control" id="exam-subject" required>
                            <option value="" disabled selected>Select subject</option>
                            <option value="bio">Biology</option>
                            <option value="geo">Geography</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exam-stage">Stage</label>
                        <select class="form-control" id="exam-stage" required>
                            <option value="" disabled selected>Select stage</option>
                            <option value="first-grade">First Grade</option>
                            <option value="second-grade">Second Grade</option>
                            <option value="third-grade">Third Grade</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exam-file">Upload Exam File</label>
                        <input type="file" class="form-control" id="exam-file" required>
                    </div>
                    <button type="submit" class="btn btn-primary mt-3">Upload Exam</button>
                </form>
            </div>
        </div>
    </div>
</div>
    <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
    <script>
        //Add Course Modal
        document.getElementById('course-upload-form').addEventListener('submit', function(event) {
    event.preventDefault();

    let formData = new FormData();
    formData.append('title', document.getElementById('course-title').value);
    formData.append('description', document.getElementById('course-description').value);
    formData.append('subject', document.getElementById('course-subject').value);
    formData.append('stage', document.getElementById('course-stage').value);
    formData.append('file', document.getElementById('course-file').files[0]);

    fetch('/api/courses', {
        method: 'POST',
        body: formData,
    }).then(response => {
        if (response.ok) {
            return response.json();
        } else {
            throw new Error('Failed to upload course');
        }
    }).then(data => {
        alert('Course uploaded successfully');
        $('#uploadCourseModal').modal('hide');
        // Optionally refresh the page or update the UI to show the new course
        addCourseToList(data);
    }).catch(error => {
        console.error('Error:', error);
        alert('Error uploading course');
    });
});

function addCourseToList(course) {
    const courseList = document.getElementById('courses-list');
    const courseItem = document.createElement('li');
    courseItem.className = 'list-group-item';
    courseItem.textContent = `${course.title} - ${course.description}`;
    courseList.appendChild(courseItem);
}
    // Assignment Modal
    document.getElementById('assignments-upload-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData();
    formData.append('title', document.getElementById('assignment-title').value);
    formData.append('description', document.getElementById('assignment-description').value);
    formData.append('subject', document.getElementById('assignment-course-select').value);
    formData.append('stage', document.getElementById('assignment-stage-select').value);
    formData.append('file_path', document.getElementById('assignment-file').files[0]);

    try {
        const response = await fetch('/assignments', {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrf-token]').content
            }
        });

        if (response.ok) {
            document.getElementById('assignment-upload-success').classList.remove('d-none');
            document.getElementById('assignment-upload-error').classList.add('d-none');
        } else {
            throw new Error('Failed to upload assignment');
        }
    } catch (error) {
        document.getElementById('assignment-upload-error').classList.remove('d-none');
        document.getElementById('assignment-upload-success').classList.add('d-none');
    }
});
// exam script section
document.getElementById('exam-upload-form').addEventListener('submit', function(event) {
    event.preventDefault();

    let formData = new FormData();
    formData.append('title', document.getElementById('exam-title').value);
    formData.append('description', document.getElementById('exam-description').value);
    formData.append('subject', document.getElementById('exam-subject').value);
    formData.append('stage', document.getElementById('exam-stage').value);
    formData.append('file', document.getElementById('exam-file').files[0]);

    fetch('/api/exams', {
        method: 'POST',
        body: formData,
    }).then(response => {
        if (response.ok) {
            return response.json();
        } else {
            throw new Error('Failed to upload exam');
        }
    }).then(data => {
        alert('Exam uploaded successfully');
        $('#uploadExamModal').modal('hide');
        // Optionally refresh the page or update the UI to show the new exam
    }).catch(error => {
        console.error('Error:', error);
        alert('Error uploading exam');
    });
});
    </script>
    <script src="{{ url_for('static', filename='External/video/js/upload.js') }}"></script>

</body>
</html>
